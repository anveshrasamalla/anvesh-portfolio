<!DOCTYPE html>
<html>
<head>
  <title>SFMC Form Test</title>
  <script src="https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY"></script>
</head>
<body style="font-family:Arial;max-width:600px;margin:30px auto;">

  <h2>SFMC Test Form</h2>
  <form id="sfmcForm" action="/bin/wcm/sfmc" method="POST">
    <input type="hidden" name="deKey" value="AEM-FORM-ENDPNT-INTRNL-TEST">
    <input type="hidden" id="MessageBody" name="MessageBody">

    <label>Form ID: <input name="FormID" value="TestForm"></label><br>
    <label>Email: <input name="Email" type="email" value="john@example.com"></label><br>
    <label>First Name: <input name="FirstName" value="John"></label><br>
    <label>Last Name: <input name="LastName" value="Doe"></label><br><br>

    <button type="submit">Submit</button>
  </form>

  <pre id="result" style="background:#f7f7f7;padding:10px;margin-top:10px;"></pre>

  <script>
    const form = document.getElementById("sfmcForm");
    form.addEventListener("submit", function(e) {
      e.preventDefault();

      const msg = Array.from(form.querySelectorAll("input"))
        .filter(i => i.type !== "hidden")
        .map(i => `${i.name}: ${i.value}`)
        .join("\r\n");
      document.getElementById("MessageBody").value = msg;

      grecaptcha.ready(() => {
        grecaptcha.execute('YOUR_SITE_KEY', {action:'submit'}).then(token => {
          const fd = new FormData(form);
          fd.append("g-recaptcha-response", token);

          fetch(form.action, {method: "POST", body: fd})
            .then(res => res.json())
            .then(data => {
              document.getElementById("result").textContent =
                `Message: ${data.message}\nError: ${data.error}\nStatus: ${data.httpCode}\nRequest ID: ${data.requestId}`;
            })
            .catch(err => {
              document.getElementById("result").textContent = "Error: " + err;
            });
        });
      });
    });
  </script>

</body>
</html>
